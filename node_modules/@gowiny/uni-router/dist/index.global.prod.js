/**
  * gowiny-uni-router v1.0.15
  * https://gitee.com/gowiny/uni-router
  *
  * (c) 2022-present gowiny
  * @license MIT
  *
  * Date: 2022-12-30T04:57:01Z
  */
var GowinyUniRouter=function(t,e,o){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=r(o);const a={INIT:"onInit",LOAD:"onLoad",SHOW:"onShow",READY:"onReady"},u={navLock:!1,beforeEachLock:!1,firstRequestState:"not",firstRequestListeners:[],handleFirstRequestResult(t){u.firstRequestListeners.forEach((e=>{e.success(t)})),u.firstRequestListeners=[]},app:void 0,route:void 0,toRoute:void 0,fromRoute:void 0,router:void 0};function s(){const t=getCurrentPages();return t.length>0?t[t.length-1]:void 0}function i(t,e,o,r){r=r||l(e,o);const n=e.replace(/^\//,""),a=t.routeMap.pathMap[n];let u;return u=a?{...a,fullPath:r,path:e,query:o}:{fullPath:r,path:e,query:o},u}function c(t,e){const o=t.indexOf("?");let r,a;o>-1?(a=t.substring(0,o),r=t.substring(o+1)):(a=t,r="");const u=r?n.default.parse(r):{},s=a.replace(/^\//,""),i=e.routeMap.pathMap[s];let c;return c=i?{...i,fullPath:t,path:a,query:u}:{fullPath:t,path:a,query:u},c}function l(t,e){const o=n.default.stringify(e);return o?`${t}?${o}`:t}function h(t,o,r,n=!1){const a={};if(e.isString(t))a.url=t;else{const e=t;let r,n=e.query;if(e.name){r=o.routeMap.nameMap[e.name].path}else r=e.path,n=e.query;const u=l(r,n),s={...e};delete s.name,delete s.path,delete s.query,Object.assign(a,s),a.url=u}let u;switch(a.$force=n,r){case"push":u=uni.navigateTo(a);break;case"replace":u=uni.redirectTo(a);break;case"pushTab":u=uni.switchTab(a);break;case"replaceAll":u=uni.reLaunch(a);break;default:throw new Error("\u8def\u7531\u7c7b\u578b\u4e0d\u6b63\u786e")}return u}function f(t,e,o){o.forEach((o=>{const r=o.path,n=r.startsWith("/")?r:"/"+r,a={...o,path:n};e[n]=a,t.push(a)}))}async function p(t,o,r,n){let a=t.lifeCycleHooks[o];return await e.queueInvoke(a,null,[r,n],(t=>!1!==t&&!e.isObject(t)))}async function d(t,e,o){return await p(t,"ae",e,o)}async function y(t,o,r){u.beforeEachLock=!0;try{const n=await p(t,"be",o,r);if(!0===n||null==n)return!0;if(!1!==n){let o,r="push";if(e.isString(n))o={path:n},r="push";else if(e.isObject(n)){const t=n;o=t.to,r=t.navType}o&&h(o,t,r,!0)}return!1}finally{u.beforeEachLock=!1}}let k=!1;const g="navigateTo",b="redirectTo",L="reLaunch",R="switchTab",w="navigateBack",v={[g]:uni.navigateTo,[b]:uni.redirectTo,[L]:uni.reLaunch,[R]:uni.switchTab,[w]:uni.navigateBack};function M(t,e,o){e.fail&&e.fail(o),e.complete&&e.complete(),t&&(u.navLock=!1)}function m(t,e){!function(t,e){const o=v[t];o&&o(e)}(t,{...e,async success(...t){try{e.success&&await e.success(...t)}finally{u.route=u.toRoute,u.lastFullPath=u.route?u.route.fullPath:void 0,u.router&&u.toRoute&&(u.router.route=u.route,await d(u.router,u.toRoute,u.fromRoute)),u.navLock=!1}},async fail(...t){try{console.error(t&&t[0]?t[0].errMsg:""),e.fail&&await e.fail(...t)}finally{u.navLock=!1}},complete(...t){e.complete&&e.complete(...t)}})}function P(t){return async function(o){if((u.navLock||u.beforeEachLock)&&!o.$force)return u.router&&function(t,...e){const o=t.options.debugger;o&&(!0===o||o.info)&&console.warn(...e)}(u.router,"\u5f53\u524d\u9875\u9762\u6b63\u5728\u5904\u4e8e\u8df3\u8f6c\u72b6\u6001\uff0c\u8bf7\u7a0d\u540e\u518d\u8fdb\u884c\u8df3\u8f6c...."),M(!1,o,"\u5f53\u524d\u9875\u9762\u6b63\u5728\u5904\u4e8e\u8df3\u8f6c\u72b6\u6001\uff0c\u8bf7\u7a0d\u540e\u518d\u8fdb\u884c\u8df3\u8f6c....");u.navLock=!0;try{if(!u.router)return m(t,o);const r=u.router;let n;if(w==t){const t=e.isNumber(o.delta)?o.delta:1,a=getCurrentPages(),u=a.length-t-1;n=u<0?c(r.indexRouteRule.path,r):function(t){let e=t.route||"";return e.startsWith("/")||(e="/"+e),{fullPath:e,path:e}}(a[u])}else{n=c(o.url,r)}const a=u.route;u.toRoute=n,u.fromRoute=a,u.destFullPath=n.fullPath;return await y(r,n,a)?m(t,o):M(!0,o,"\u8def\u7531\u5b88\u536b\u62e6\u622a")}catch(t){return M(!0,o,t)}}}const T=[a.INIT,a.LOAD,a.SHOW,a.READY];function E(t){return t.__routerData||(t.__routerData={}),t.__routerData}function O(t,e){const o=function(t){const e=E(t);return e.oriHookDataMap||(e.oriHookDataMap={}),e.oriHookDataMap}(t);let r=o[e];return r||(r={oldVal:[]},o[e]=r),r}function q(t,e,o){const r=(E(e).oldMethods||{})[t];if(r)return r.apply(e,o)}function V(t,o,r){const n=O(o,t);e.invoke(n.oldVal,o,r)}function x(t,e){E(t).oriRoute=e}function A(t,e,o={}){const r=s();if(!r||!r.route)return;const n="/"+r.route;x(e,{path:n,query:o});const a=i(t,n,o);t.route=a}async function D(t,e,o,r,n,c){const h=E(o);if(!0===(h.hookLock||!1)){h.hookListeners||(h.hookListeners=[]);const t=new Promise(((t,e)=>{h.hookListeners.push({success:t,fail:e})}));let e;return await t&&(e=c(r,o,n)),e}let f;h.hookLock=!0;try{const p=function(){const t=s();return t&&t.route?"/"+t.route:void 0}();let k;if("hook"!==e||a.INIT!=r&&a.LOAD!=r)k=function(t){const e=E(t);return e.oriRoute||(e.oriRoute={}),e.oriRoute}(o).query||{};else{k=n[0]||{};Object.keys(k).forEach((t=>{const e=k[t];e&&(k[t]=decodeURIComponent(e))})),x(o,{path:p,query:k})}let g=!0;if(p){const e=l(p,k);if(u.destFullPath!=e){const o=i(t,p,k,e),r=u.route;u.toRoute=o,u.fromRoute=r,g=await y(t,o,r),g&&(u.route=o,t.route=o,u.lastFullPath=e,await d(t,o,r))}}if(g&&(f=c(r,o,n)),h.hookListeners){const t=h.hookListeners;for(let e=0;e<t.length;e++){t[e].success(g)}h.hookListeners=[]}}catch(t){if(h.hookListeners){const e=h.hookListeners;for(let o=0;o<e.length;o++){e[o].fail(t)}h.hookListeners=[]}}return h.hookLock=!1,f}function $(t,e,o){return function(...r){!function(t,e,o,r){D(t,"hook",e,o,r,V)}(t,e,o,r)}}function j(t,e,o="",r){if(!r||0==r.length)return;const n=e.pathMap,a=e.nameMap;r.forEach((r=>{const{alias:u,path:s,name:i}=r;if(null==s)throw new Error(`\u8bf7\u63d0\u4f9b\u4e00\u4e2a\u5b8c\u6574\u7684\u8def\u7531\u5bf9\u8c61\uff0c\u5305\u62ec\u4ee5\u7edd\u5bf9\u8def\u5f84\u5f00\u59cb\u7684 \u2018path\u2019 \u5b57\u7b26\u4e32 ${JSON.stringify(r)}`);if(n[o+s]=r,i&&(a[i]=r),u)if(Array.isArray(u))u.forEach((t=>{n[o+t]=r}));else{n[o+u]=r}j(t,e,r.path,r.children)}))}function H(t,e){const o={pathMap:Object.create(null),nameMap:Object.create(null)};return j(t,o,"",e),o}function I(t,e,o){let r=t.lifeCycleHooks[e];r||(r=[],t.lifeCycleHooks[e]=r),r.push(o)}function C(t){return"page"===t.$mpType}class _{proxyMode;proxyMethods;routes;indexRouteRule;lifeCycleHooks={};$locked=!1;options;routeMap;route;constructor(t){this.options=t,this.proxyMode=t.proxyMode||"hook",this.proxyMethods=t.proxyMethods||T,this.routes=function({pages:t,subPackages:e=[]}){const o=[],r={};return f(o,r,t),e.forEach((t=>{f(o,r,t.pages)})),o}(t.pageData),this.indexRouteRule=this.routes[0],this.routeMap=H(this,this.routes)}setupRouter(t){t.use(this)}push(t){return h(t,this,"push")}replace(t){return h(t,this,"replace")}replaceAll(t){return h(t,this,"replaceAll")}pushTab(t){return h(t,this,"pushTab")}back(...t){return uni.navigateBack(...t)}beforeEach(t){I(this,"be",t)}afterEach(t){I(this,"ae",t)}async install(t,...e){const o=this;let r;u.app=t,u.router=o,Object.defineProperty(t.config.globalProperties,"$Router",{get:()=>o}),Object.defineProperty(t.config.globalProperties,"$Route",{get:()=>o.route}),"hook"===o.proxyMode?r={beforeCreate(){if(!C(this))return;const t=this;o.proxyMethods.forEach((e=>{const r=O(t,e),n=t.$[e]||[],a=Array.isArray(n)?n:[n];r.oldVal=a,r.wapper=$(o,t,e);const u=[r.wapper],s=u;u.push=function(...t){return r.oldVal.push(...t),u.length},u.pop=function(){return r.oldVal.pop()},u.shift=function(){return r.oldVal.shift()},u.unshift=function(...t){return r.oldVal.unshift(...t),u.length},s.splice=function(...t){return r.oldVal.splice(...t)},u.reverse=function(){return r.oldVal.reverse()},u.sort=function(){return r.oldVal.sort()},r.newVal=u,Object.defineProperty(t.$,e,{get:()=>r.newVal,set(t){t!==r.newVal&&t!==r.wapper&&(t?Array.isArray(t)?t.indexOf(r.wapper)>-1?t.length>1&&t.forEach((t=>{t!==r.wapper&&r.oldVal.push(t)})):r.oldVal=t:r.oldVal=[t]:r.oldVal=[])}})}))}}:"method"===o.proxyMode&&(r={created(){if(!C(this))return;const t=this,e=E(t),r={};e.oldMethods=r,o.proxyMethods.forEach((e=>{const n=t[e];n?(r[e]=n,t[e]=(...r)=>function(t,e,o,r){return D(t,"method",e,o,r,q)}(o,t,e,r)):console.warn(`\u6b64\u9875\u9762\u6ca1\u6709\u65b9\u6cd5:${e}`)}))},onInit(t){C(this)&&A(o,this,t)},onLoad(t){C(this)&&A(o,this,t)}}),r&&t.mixin(r),k||(k=!0,uni.navigateTo=P(g),uni.redirectTo=P(b),uni.reLaunch=P(L),uni.switchTab=P(R),uni.navigateBack=P(w))}}return t.UniLifecycleHooks=a,t.createRouter=function(t){return new _(t)},Object.defineProperty(t,"__esModule",{value:!0}),t}({},GowinyUtils,qs);